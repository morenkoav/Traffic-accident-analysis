# Аналитика ДТП по данным проекта "Карта ДТП"

Заказчиком (Оунером задачи) выступает проект «Карта ДТП» https://dtp-stat.ru/ — некоммерческий проект, посвященный проблеме дорожно-транспортных происшествий в России. Это платформа сбора данных о ДТП, бесплатный и открытый сервис аналитики ДТП.

**Цель проекта** - провести глубокий анализ данных, сформулировать и проверить гипотезы, опираясь на доступные признаки.

**Задачи**
* Провести исследовательский анализ данных о ДТП за 2025 год.
* Сформулировать и проверить не менее трех гипотез, основываясь на имеющихся признаках.
* Провести анализ ДТП по всем датасетам, представленным на сайте.
* Построить дашборд используя любой удобный инструмент, с учетом того, что дашборд может быть опубликован

**Декомпозиция работы:**
* Загрузка датасета и знакомство с данными
* Предобработка данных
* Исследовательский анализ данных
* Проверка гипотез
* Общие выводы
* Подготовка дашборда

Прототип дашборда: [ссылка](https://datalens.yandex/xvrr928ale9ci)

**Содержание репозитория:**
* [Полная версия тетрадки](https://github.com/morenkoav/Traffic-accident-analysis/blob/main/TAA_main.ipynb)
* [Сокращенная версия тетрадки](https://github.com/morenkoav/Traffic-accident-analysis/blob/main/TAA_main_short_version.ipynb)

* [Скрипты SQL для загрузки данных в БД](https://github.com/morenkoav/Traffic-accident-analysis/blob/main/SQL_scripts.ipynb)


## Основные выводы:
1. **Загрузка датасета и знакомство с данными**
* Реализована схема скачивания и открытия датасетов:
    * Скачивание архивированных файлов с сайта проекта -> разархивация файлов -> чтение файлов с помощью json.load() и сохранение в список -> объединение списка в единый DataFrame.


* Датасеты содержат информацию:
    * `id`: идентификатор
    * `light`: время суток
    * `point`: координаты (гео)
    * `nearby`: комментарий по месту происшествия (где произошло)
    * `region`: город/район
    * `address`: адрес
    * `weather`: погода
    * `category`: тип ДТП
    * `datetime`: дата и время происшествия
    * `severity`: тяжесть ДТП/вред здоровью
    * `vehicles`: участники – транспортные средства:
        * `year`: год производства транспортного средства
        * `brand`: марка транспортного средства
        * `color`: цвет транспортного средства
        * `model`: модель транспортного средства
        * `category`: категория транспортного средства
        * `role`: роль участника
        * `gender`: пол участника
        * `violations`: нарушения правил участником
        * `health_status`: состояние здоровья участника
        * `years_of_driving_experience`: стаж вождения участника (только у водителей)
    * `dead_count`: кол-во погибших в ДТП
    * `participants`: участники без транспортных средств (описание, как у участников внутри транспортных средств)
    * `injured_count`: кол-во раненых в ДТП
    * `parent_region`: родительский регион
    * `road_conditions`: состояние дорожного покрытия
    * `participants_count`: кол-во участников ДТП
    * `participant_categories`: категории участников


2. **Предобработка датасета**
* В результате предобработки из датасета полученного на предыдущем этапе (с информацией об участниках ДТП) выделены два датасета - с информацией о транспортных средствах и с информацией об участниках - людях.


    * **Датасет с общей информацией о ДТП (`general_df`)**
        * Списки в полях `tags`, `nearby`, `weather`, `road_conditions`, `participant_categories` преобразованы в строки
        * удален столбец `tags` (не нес смысловой нагрузки)
        * Поле `point` с координатами места ДТП распарсено в два столбца с широтой и долготой
        * Поле `geometry` удалено, так содержит дублирование информации с координатами места ДТП
        * Поле `address` удалено, так как точный адрес в контесте анализа не представляет интереса, а также есть информация с координатами
        * Пропуски по полю `scheme` заполнены заглушкой "unknown"
        * Пропуски по полям `lat` и `long` удалены
        * Поля `region`, `scheme`, `weather`, `category`, `severity`, `parent_region` приведены к типу category для оптимизации памяти
        * Поля `dead_count`, `injured_count` приведены к типу int8 для оптимизации памяти
        * Поле `datetime` приведено к типу даты-времени
        * Добавлены поля с днем, годом, месяцем и часом возникновения ДТП
        * Добавлены бинарные категориальные признаки освещения в момент ДТП:
            * Светлое время - `light_day`
            * Темное время суток, освещение включено - `dark_light_on`
            * В темное время суток, освещение отсутствует - `dark_no_light`
            * В темное время суток, освещение не включено - `dark_light_off`
            * Сумерки - `twilight`
        * По полю `nearby` унифицировано написание некоторых категорий, также выделены следующие признаки:
            * Признак перекрестка `crossroads`
            * Признак пешеходного перехода `pedestrian_crossing`
            * Признак ЖД переезда `railway_crossing`
            * Признак кругового движения `circular_motion`
            * Признак регулируемости `regulated`
        * На основе поля `weather` добавлены следующие категории:
            * Признак ясной погоды `is_clear`
            * Признак пасмурной погоды `is_cloudy`
            * Признак снегопада `is_snowfall`
            * Признак метели `is_snowstorm`
            * Признак дождя `is_rain`
            * Признак тумана `is_fog`
            * Признак ураганного ветра `is_hurricane`
        * На основе признака `category` добавлены следующие признаки:
            * Признак наезда / столкновения с человеком `is_collision_with_human`
            * Признак наезда / столкновения с велосипедистом `is_collision_with_cyclist`
            * Признак наезда / столкновения с животным `is_collision_with_animal`
            * Признак возгорания `is_fire`
        * На основе признака `road_conditions` добавлены следующие признаки:
            * Признак проблем связанных со снегом и обледенением `ice_troubles`
            * Признак проблем связанных с освещением `light_troubles`
            * Признак проблем связанных с исправностью дорожного покрытия `road_coating_troubles`
            * Признак проблем связанных со светофорами `traffic_lights_troubles`
        * На основе признака `participant_categories` добавлены следующие категории:
            * Признак мотоциклиста `participant_biker`
            * Признак пешехода `participant_pedestrian`
            * Признак велосипедиста `participant_cyclist`
            * Признак общественного транспорта `participant_public_transport`


    * **Датасет с информацией о ТС (`vehicles_df`)**
    
        * Данные с пропусками по году выпуска (`year`) удалили
        * Пропуски марки автомобиля (`brand`) заполним заглушкой "unknown"
        * Пропуски цвета ТС (`color`) заполнили заглушкой "unknown"
        * Пропуски модели ТС (`model`) заполнили заглушкой "unknown"
        * Пропуски категории ТС (`category`) заполним заглушкой "unknown"
        * Привели поле `year` к  типу int16
        * Поля `brand`, `color`, `model`, `category` привели к категориальному типу
        * Удалено 10.6 тыс. дубликатов
        * Записи в поле `color` содержащие "не заполнено" заменены на "unknown"
        * Удалены лишние пробелы в начале или конце строк поля `brand`
        * Удалены записи с аномальным годом выпуска транспортного средства (`year`) - все, что ниже 1-го перцентиля
        * Добалена информация о регионе и дате ДТП
        * Добавлен признак возраста транспортного средства

    * **Датасет с информацией об участниках ДТП (`participants_df`)**
    
        * Списки в поле `violations` преобразованы в строки
        * Пропуски в поле участника ДТП (`gender`) и статуса здоровья (`health_status`) удалили
        * Пропуски по полю водительского стажа (`years_of_driving_experience`) не заполняли, т.к. не ко всем категориям участников данное поле применимо, а также заполнение его может исказить данные.
        * Поле `years_of_driving_experience` привели к типу float16
        * Поля `role`, `gender` приведены к категориальному типу
        * Обнаружено и удалено 148.5 тыс. дубликатов
        * Добалена информация о регионе и дате ДТП
        * Пустые строки в `violations` заменены на "unknown"
        * Поле `violations` содержало информацию о перечне зафиксированных нарушений для каждого участника - разбили данное поле на отдельные нарушения по каждому участнику - датасет увеличился "в длину", так чтобы для каждой записи в датасете в поле violations содержалась информация только об одном уникальном нарушении
        * Категории поля `health_status` унифицированы до следующих категорий:
            * скончался
            * не пострадал
            * получил травмы
        * Категории поля `role` унифицированы до следующего перечня ролей участников ДТП:
            * Водитель
            * Пассажир
            * Велосипедист
            * Пешеход
            * Сотрудник ДПС
            * Сотрудник полиции или иных органов
            * Дорожный рабочий
            * Всадник
            * Работник иных организаций
            * Погонщик скота
            * Иной участник

4. **Исследовательский анализ данных**
* **Обобщенные данные о ДТП**
  * **Количество погибших (`dead_count`)**
    * В 90% ДТП нет погибших
    * В 8.4% ДТП - 1 погибший

    * **Количество пострадавших (`injured_count`)**
        * Чаще всего в результате ДТП оказывается пострадавшим 1 человек - 73% случаев. На втором месте по доли случаев - 2 пострадавших (около 14%)
        * в 6% случаев в результате ДТП не оказывается пострадавших

    * **Количество участников (`participants_count`)**
        * Чаще всего в ДТП 2 участника - 57% случаев. На втором месте по доли случаев - 3 участника (21%)
        * в 9% случаев в ДТП 1 участник

    * **Год ДТП (`year`)**
        * В датасете представлены данные с 2015 по 2025 г. 2025 - неполный.
        * Видна динамика снижения абсолютного количества ДТП, если брать статистику за полные года, то минимальное количество ДТП было в 2022 г.
    
    * **Месяц ДТП (`month`)**
        * С мая по октябрь количество ДТП выше чем в другие месяца
        * В августе происходит больше всего ДТП.
        * Самые "спокойные" месяца - февраль, март, апрель

    
    * **Час ДТП (`hour`)**
        * В течение дня можно выделить следующие периоды по количеству фиксируемых ДТП:
            * 0-4 часа - Количество ДТП снижается
            * 5-6 часов - начинается рост кол-ва ДТП, видимо за счет того, что люди начинают выезжать на работу (например у кого рабочая смена начинается в 7)
            * 7-8 часов - резкий рост количества ДТП - время когда в основом все люди выезжают на работу / учебу
            * 9-16 часов - после локального пика количества ДТП в 8 часов происходит небольшое снижение количества фиксируемых случаев, и начиная с 9 до 16 часов плавно растет.
            * 17-18 часов - резкий рост относительно 16 часов, пиковое время по количеству фиксируемых ДТП в течение дня. В это время в основном заканчивается работа / учеба - люди выезжают домой или по другим делам. К вечеру накапливается усталость, притупляется внимание, возможно этим можно объяснить пиковые значения количества фиксируемых ДТП.
            * 19-23 часа - количество фиксируемых ДТП быстро снижается, люди добираются до дома, машин становится меньше.
            * Наименьшее количество случаев ДТП - в 4 часа утра.


    * **ДТП в светлое время суток (`light_day`)**
        * Данный признак частично коррелирует с разбивкой ДТП по часам. 63% ДТП происходят в светлое время суток
     
    * **ДТП В темное время суток, освещение включено (`dark_light_on`)**
        * 22% ДТП происходит в темное время суток с включенным освещением
     
    * **ДТП в темное время суток, освещение отсутствует (`dark_no_light`)**
        * 11% ДТП связано с темным временем суток и отсутствующим освещением.
     
    * **Перекресток (`crossroads`)**
        * Перекресток - место повышенной опасности, 35% ДТП происходит на перекрестке или рядом с ним.
     
    * **Пешеходный переход (`pedestrian_crossing`)**
        * 28% ДТП связано с пешеходными переходами.
    
    * **Регулируемый участок (`regulated`)**
        * 84% ДТП происходит на нерегулируемых участках дорог, и только 16% - на регулируемых. 
    
    * **Ясная погода (`is_clear`)**
        * Почти 60% ДТП происходит в ясную погоду
    
    * **Дождь (`is_rain`)**
        * Только 5% ДТП связано с дождивой погодой  
    
    * **Пасмурная погода (`is_cloudy`)**
        * Около 32% ДТП происходит в пасмурную погоду.

    * **Столкновение с человеком (`is_collision_with_human`)**
        * 28% ДТП связано со столкновением с человеком
     
    * **Столкновение с велосипедистом (`is_collision_with_cyclist`)**
        * Менее 4% ДТП связано со столкновением с велосипедистом
    
    * **Обледение дорожного покрытия (`ice_troubles`)**
        * Почти 15% ДТП связано с проблемами обледенения дорожного покрытия (гололед или снежный накат)
    
    * **Участник ДТП - мотоциклист (`participant_biker`)** 
        * В почти 8% ДТП учавствуют мотоциклисты
     
    * **Участник ДТП - пешеход (`participant_pedestrian`)** 
        * В 29% ДТП учавствуют пешеходы
     
    * **Участник ДТП - велосипедист (`participant_cyclist`)**
        * Менее чем в 4% ДТП участвуют велосипедисты
    
    * **Степень тяжести (`participant_cyclist`)**
        * 57% ДТП имеют лёгкую тяжесть / последствия для здоровья, около 34% - тяжелые случаи, а чуть менее 10% ДТП заканчиваются летальным исходом.


     
* **Данные о транспортных средствах**

    * Основная часть автомобилей-участников ДТП была выпущена в период с 1999 по 2021 г.
    * Самый частый возраст ТС на момент ДТП - до 15 лет.
    * ТОП-3 цвета автомобилей попадающих в ДТП:
        * Белый (24%)
        * Серый (17.7%)
        * Черный (14.4%)
    * Из топ-10 автомобилей чаще всего попадающих в ДТП - 6 - автомобили марки ВАЗ (Гранта, Приора, 2114, 2108(09), Калина, 2107). Также в топ-10 попали марки наиболее часто встречающиеся в сервисах такси - Хёндэ Солярис, КИА Рио, Рено Логан.
    * Чаще всего в ДТП попадают автомобили B, C, D класса, мотоциклы и прочие легковые автомобили.



* **Данные об участниках ДТП**

    * Самая частая категория участников ДТП - водитель (72%), на втором месте - пассажир (16%), на третьем - пешеход (около 11%).
    * 75% участников ДТП - мужчины
    * Медианный стаж водителя - участника ДТП - 12 лет.
    * У 39% записей в датасете отсутствует отметка о категории нарушения.
    * Самые популярные категории нарушений:
        * Несоблюдение требований ОСАГО
        * Несоблюдение очередности проезда
        * Несоответствие скорости конкретным условиям движения
        * Нарушение правил расположения ТС на проезжей части
        * Неправильный выбор дистанции


4. **Проверка гипотез**

    * Подтвердилась гипотеза о том, что в ДТП связанных с нарушением скоростного режима погибает людей меньше, чем в ДТП связанных с употреблением алкоголя или наркотических веществ.
       
    * Подтвердилась гипотеза о том, что в ДТП связанных с употреблением алкоголя и наркотических веществ погибает людей больше, чем в ДТП не связанных с употреблением алкоголя / наркотиков
    
    * Подтвердилась гипотеза о том, что летом ежедневно происходит ДТП больше, чем в остальное время года.
    
    * Подтвердилась гипотеза о том, что в августе ДТП происходят чаще, чем в остальные месяцы года.
  
    * Подтвердилась гипотеза о том, что в ДТП на перекрестках в среднем погибает людей больше, чем в ДТП на пешеходном переходе.
  
    * Подтвердилась гипотеза о том, что в ДТП с участием а/м ВАЗ погибает людей больше, чем в ДТП с участием иных марок автомобилей.
  
    * Не удалось подтвердить гипотезу об отсутствии различия в среднем водительском стаже в ДТП со смертельным исходом и без него. Средний стаж водителей в ДТП со смертельным исходом оказался выше, чем в ДТП без смертельного исхода.
  
    * Подтвердилась гипотеза о том, что в ДТП с участием водителей-мужчин в среднем погибает людей больше, чем в ДТП с участием женщин-водителей
  
5. **Дополнительные материалы**
    * На основе изученных данных разработан дашборд на базе DataLens - [ссылка](https://datalens.yandex/xvrr928ale9ci)